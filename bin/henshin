#!/usr/bin/env ruby
#
# Usage:
#    henshin [options] [input] [output]
#    henshin help
#
$: << File.dirname(__FILE__) + '/../lib'

require 'henshin/cli'

module Henshin

  # Extend the command line interface with `new` command.
  class CLI
  
    EXAMPLES_DIR = Pathname.new(__FILE__).dirname + '..' + 'examples'
  
    desc 'Generate new files or sites'
    command :new do
    
      desc 'Create a new post for site in current directory'
      flag :post, :arg => "[TITLE]" do |t|
        post = <<EOS
---
title: #{t}
date: #{Time.now.strftime("%Y-%m-%d %H:%M")}
---
     
EOS
        f = File.new("posts/#{t}.md")
        f.puts(post)
        f.close
      end
      
      desc 'Create a new site in current directory'
      flag :site, :args => "[NAME]" do |n|
        n = '.' unless n
        FileUtils.cp_r(EXAMPLES_DIR + 'site', n)
        exit
      end
      
      desc 'Create a new blog in current directory'
      flag :blog, :arg => "[NAME]" do |t|
        n = '.' unless n
        FileUtils.cp_r(EXAMPLES_DIR + 'blog', n)
        exit
      end
    
    end
  
  end
end

Henshin.parse!(ARGV)
