#!/usr/bin/env ruby

require File.dirname(__FILE__) + '/../lib/henshin'
require 'optparse'

banner = <<EOS
Usage: henshin
       henshin [path to source]
       henshin [path to source]:[path to write]
EOS


override = {}
opts = OptionParser.new do |opts|
  opts.banner = banner
end
opts.parse!

if ARGV[0]
  override[:root] = ARGV[0].split(':')[0]
  override[:target] = ARGV[0].split(':')[1] if ARGV[0].split(':')[1]
end


config = Henshin.configure(override)
site = Henshin::Site.new(config)

puts "Reading files..."
site.read

site.process
site.render

puts "Writing files..."
site.write

puts "Site created in #{config[:target]}"